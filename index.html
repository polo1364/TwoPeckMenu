<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æ´¾å…‹ç‚¸é›é»é¤ç³»çµ±</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: "Noto Sans TC", "Microsoft JhengHei", sans-serif;
      padding: 20px;
      background: #fffbe6;
      color: #333;
      max-width: 960px;
      margin: auto;
    }
    h1, h2 {
      text-align: center;
      color: #b30000;
      margin: 20px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      background: #fff;
    }
    th {
      background-color: #f0f0f0;
      color: #333;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    select, input[type="number"], input[type="text"] {
      width: 100%;
      padding: 6px;
      box-sizing: border-box;
      font-size: 14px;
    }
    .buttons {
      text-align: center;
      margin: 20px 0;
    }
    button {
      margin: 6px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background: #b30000;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #d40000;
    }
    .only-print {
      display: none;
      text-align: center;
      font-size: 18px;
      margin-top: 30px;
    }
@media print {
  @page {
    size: A4 portrait;
    margin: 12mm;
  }

  body {
    margin: 0;
    padding: 0;
    -webkit-print-color-adjust: exact;
    font-family: "Microsoft JhengHei", sans-serif;
  }

  .no-print,
  .no-print * {
    display: none !important;
  }

  #summary {
    margin-top: 0;
    padding: 20px;
  }

  #summary table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }

  #summary th, #summary td {
    border: 1px solid #000;
    padding: 6px 8px;
    font-size: 14px;
    text-align: center;
    word-break: break-word;
  }

  #summary th {
    background: #f2f2f2;
  }

  #footer {
    text-align: center;
    font-size: 16px;
    margin-top: 30px;
  }

  #printTime {
    text-align: center;
    font-size: 12px;
    margin-top: 10px;
  }
}

  </style>
</head>

  <body>
  <h1>æ´¾å…‹ç‚¸é›é»é¤ç³»çµ±</h1>
  <div class="no-print">
    <table>
      <thead>
        <tr><th>åˆ†é¡</th><th>å“é …</th><th>åƒ¹æ ¼</th><th>æ•¸é‡</th><th>å‚™è¨»</th></tr>
      </thead>
      <tbody id="orderTable"></tbody>
    </table>
    <div class="buttons">
      <button onclick="addRow()">â• æ–°å¢å“é …</button>
      <button onclick="generateSummary()">ğŸ“Š çµ±è¨ˆç¸½é‡‘é¡</button>
      <button onclick="print()">ğŸ–¨ï¸ åˆ—å°</button>
      <button onclick="clearAll()">ğŸ—‘ï¸ æ¸…é™¤</button>
    </div>
  </div>

  <div id="summary"></div>
  <div id="footer" class="only-print">
    <p>å¤§ç‘ç§‘æŠ€</p>
    <p>é«˜é›„å¸‚å¤§å¯®å€é³³æ—äºŒè·¯532è™Ÿ</p>
    <p>(07)7871875</p>
  </div>
  <div id="printTime" class="only-print"></div>

  <script>
    const menu = {
      "å¥—é¤": {
        "1è™Ÿé¤(è„†çš®é›è…¿Ã—7+ç¿…Ã—2+é¦¬éˆ´è–¯x1+åœ°ç“œæ¢x1+ç”œä¸è¾£Ã—1+é£²ç“¶x1)": 489,
        "2è™Ÿé¤(é›å¤§è…¿Ã—3+é›å°è…¿Ã—3)": 279,
        "3è™Ÿé¤(é›ç¿…Ã—1+å¤§è…¿x1+å°è…¿x1)": 125,
        "4è™Ÿé¤(å¤§è…¿Ã—1+å°è…¿x1+è–¯æ¢/åœ°ç“œæ¢/ç”œä¸è¾£+ç´…èŒ¶/ç¶ èŒ¶)": 139,
        "5è™Ÿé¤(é›ç¿…Ã—6)": 189,
        "6è™Ÿé¤(é›æ’+è–¯æ¢/åœ°ç“œæ¢/ç”œä¸è¾£+ç´…èŒ¶/ç¶ èŒ¶)": 125,
        "7è™Ÿé¤ï¼ˆé›æ’+çƒˆç«é»‘ç³–çå¥¶ï¼‰": 115
      },
      "ç‚¸é›": {
        "è„†çš®é›æ’": 85, "è„†çš®é›è…¿æ’": 85, "è„†çš®é›å¡Š": 70, "è„†çš®é›æŸ³": 75,
        "è„†çš®é›ç¿…": 35, "è„†çš®é›è…¿": 50, "æ³°é…¥æ˜Ÿæ˜Ÿé­š": 60, "çˆ†è›‹æŸ³è‘‰é­š": 60,
        "é…¥ç‚¸ä¸‰è§’éª¨è‚‰": 65, "è„†çš®é­·é­š": 75, "è„†çš®é›è»Ÿéª¨": 70
      },
      "é£²æ–™": {
        "éŒ«è˜­ç´…èŒ¶å†°": 30, "å¤æ—©å‘³ç´…èŒ¶å†°": 30, "ç¶ èŒ¶": 30, "ä»™è‰ç”˜èŒ¶": 35,
        "æ´¾å…‹å¥¶èŒ¶": 45, "æ´¾å…‹é®®å¥¶èŒ¶": 50, "å¤æ—©å‘³é®®å¥¶èŒ¶": 55, "å¤šå¤šç¶ ": 45,
        "çƒˆç«é»‘ç³–çå¥¶": 55, "çƒˆç«é»‘ç³–çç é®®å¥¶èŒ¶": 60, "çƒˆç«é»‘ç³–çç æ’å¥¶": 65,
        "å¸ƒä¸å¥¶èŒ¶": 55, "å¸ƒä¸é®®å¥¶èŒ¶": 60, "å¯å£å¯æ¨‚": 30, "é›ªç¢§": 30,
        "å¯æ¨‚/æ¯": 35, "é›ªç¢§/æ¯": 35
      },
      "é»å¿ƒ": {
        "é¦¬åŠ é§±èµ·å¸æ¢": 50, "æ³¢æ³¢èµ·å¸çƒ": 35, "è„†çš®é¦¬éˆ´è–¯æ¢": 35, "ç‰ç±³å¸ƒä¸é…¥": 35,
        "ç…‰ä¹³éŠ€çµ²æ²": 35, "æ¢…å­åœ°ç“œæ¢": 35, "è„†çš®ç”œä¸è¾£": 35, "è„†çš®æé®‘è‡": 35,
        "QQåœ°ç“œçƒ": 35, "æ´‹è”¥åœˆ": 35, "é¦™é…¥å››å­£è±†": 35, "è„†çš®é›çš®": 35,
        "è„†çš®ä¸ƒé‡Œé¦™": 35, "è„†çš®é›å¿ƒ": 35, "è„†çš®èŠ±æä¸¸": 30, "é…¥ç‚¸èŠ‹é ­é¤…": 30,
        "è–¯é¤…": 25, "æ‰‹å·¥é»‘è¼ªç‰‡": 25, "è„†çš®ç™¾é è±†è…": 25, "è„†çš®ç±³è…¸": 25,
        "è„†çš®è¡€ç³•": 25, "è˜¿è””ç³•": 25
      }
    };

    const discountMap = {
      'éŒ«è˜­ç´…èŒ¶å†°': 20, 'å¤æ—©å‘³ç´…èŒ¶å†°': 20, 'ç¶ èŒ¶': 20, 'ä»™è‰ç”˜èŒ¶': 25,
      'æ´¾å…‹å¥¶èŒ¶': 35, 'æ´¾å…‹é®®å¥¶èŒ¶': 40, 'å¤æ—©å‘³é®®å¥¶èŒ¶': 45, 'å¤šå¤šç¶ ': 35,
      'çƒˆç«é»‘ç³–çå¥¶': 45, 'çƒˆç«é»‘ç³–çç é®®å¥¶èŒ¶': 50, 'çƒˆç«é»‘ç³–çç æ’å¥¶': 55,
      'å¸ƒä¸å¥¶èŒ¶': 45, 'å¸ƒä¸é®®å¥¶èŒ¶': 50, 'å¯å£å¯æ¨‚': 25, 'é›ªç¢§': 25,
      'å¯æ¨‚/æ¯': 30, 'é›ªç¢§/æ¯': 30
    };

    function addRow() {
      const row = document.createElement('tr');
      const typeSel = document.createElement('select');
      typeSel.innerHTML = `<option disabled selected>è«‹é¸åˆ†é¡</option>` + Object.keys(menu).map(c => `<option value="${c}">${c}</option>`).join('');
      const itemSel = document.createElement('select');
      itemSel.innerHTML = `<option disabled selected>è«‹å…ˆé¸åˆ†é¡</option>`;
      const priceCell = document.createElement('td');
      priceCell.textContent = "-";
      const qtyInput = document.createElement('input'); qtyInput.type = 'number'; qtyInput.min = 1; qtyInput.value = 1;
      const noteInput = document.createElement('input'); noteInput.type = 'text'; noteInput.placeholder = 'å‚™è¨»';
      typeSel.onchange = () => {
        itemSel.innerHTML = `<option disabled selected>è«‹é¸æ“‡å“é …</option>` + Object.keys(menu[typeSel.value]).map(i => `<option value="${i}">${i}</option>`).join('');
      };
      itemSel.onchange = () => {
        priceCell.textContent = menu[typeSel.value][itemSel.value];
      };
      row.appendChild(document.createElement('td')).appendChild(typeSel);
      row.appendChild(document.createElement('td')).appendChild(itemSel);
      row.appendChild(priceCell);
      row.appendChild(document.createElement('td')).appendChild(qtyInput);
      row.appendChild(document.createElement('td')).appendChild(noteInput);
      document.getElementById('orderTable').appendChild(row);
    }

        function generateSummary() {
      let total = 0;
      let hasChicken = false;
      const rows = document.querySelectorAll('#orderTable tr');
      let summaryHTML = '<h2>çµ±è¨ˆçµæœ</h2><table><tr><th>å“é …</th><th>å–®åƒ¹</th><th>æ•¸é‡</th><th>å°è¨ˆ</th><th>å‚™è¨»</th></tr>';

      // æª¢æŸ¥æ˜¯å¦åŒ…å«ä¸»é¤é›æ’é›è…¿æ’ â†’ é£²æ–™å¯æŠ˜æ‰£
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        const type = cells[0].querySelector('select')?.value;
        const item = cells[1].querySelector('select')?.value;
        if (type === 'ç‚¸é›' && ['è„†çš®é›æ’', 'è„†çš®é›è…¿æ’'].includes(item)) {
          hasChicken = true;
        }
      });

      // å»ºç«‹çµ±è¨ˆè¡¨æ ¼
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        const type = cells[0].querySelector('select')?.value;
        const item = cells[1].querySelector('select')?.value;
        let unitPrice = parseInt(cells[2].textContent);
        const qty = parseInt(cells[3].querySelector('input')?.value);
        const note = cells[4].querySelector('input')?.value;

        if (!item || isNaN(unitPrice) || isNaN(qty)) return;

        // å¥—ç”¨é£²æ–™æŠ˜æ‰£
        if (hasChicken && type === 'é£²æ–™' && discountMap[item]) {
          unitPrice = discountMap[item];
        }

        const subtotal = unitPrice * qty;
        total += subtotal;

        summaryHTML += `<tr>
          <td>${item}</td>
          <td>${unitPrice}</td>
          <td>${qty}</td>
          <td>${subtotal}</td>
          <td>${note}</td>
        </tr>`;
      });

      summaryHTML += `<tr><td colspan="3">ç¸½é‡‘é¡</td><td colspan="2">$${total}</td></tr></table>`;
      document.getElementById('summary').innerHTML = summaryHTML;

      // é¡¯ç¤ºåˆ—å°æ™‚é–“
      const now = new Date();
      const timeString = now.toLocaleString("zh-TW", { hour12: false });
      document.getElementById('printTime').innerText = "åˆ—å°æ™‚é–“ï¼š" + timeString;
    }

    function clearAll() {
      document.getElementById('orderTable').innerHTML = '';
      document.getElementById('summary').innerHTML = '';
      document.getElementById('printTime').innerText = '';
    }

    // é è¨­æ–°å¢ä¸€åˆ—
    window.onload = addRow;
  </script>
</body>
</html>
