    function generateSummary() {
      let total = 0;
      let hasChicken = false;
      const rows = document.querySelectorAll('#orderTable tr');
      let summaryHTML = '<h2>統計結果</h2><table><tr><th>品項</th><th>單價</th><th>數量</th><th>小計</th><th>備註</th></tr>';
      
      // 判斷是否有主餐，供飲料折扣使用
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        const type = cells[0].querySelector('select')?.value;
        const item = cells[1].querySelector('select')?.value;
        const unitPrice = parseInt(cells[2].textContent);
        if (type === '炸雞' && ['脆皮雞排', '脆皮雞腿排'].includes(item)) hasChicken = true;
      });

      // 產出統計表格內容
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        const type = cells[0].querySelector('select')?.value;
        const item = cells[1].querySelector('select')?.value;
        let unitPrice = parseInt(cells[2].textContent);
        const qty = parseInt(cells[3].querySelector('input').value);
        const note = cells[4].querySelector('input').value;
        if (!item || isNaN(unitPrice) || isNaN(qty)) return;
        if (hasChicken && type === '飲料' && discountMap[item]) {
          unitPrice = discountMap[item];
        }
        const subtotal = unitPrice * qty;
        total += subtotal;
        summaryHTML += `<tr>
          <td>${item.replace(/\n/g, ' ').replace(/<br\s*\/?>/gi, ' ')}</td>
          <td>${unitPrice}</td>
          <td>${qty}</td>
          <td>${subtotal}</td>
          <td>${note.replace(/\n/g, ' ').replace(/<br\s*\/?>/gi, ' ')}</td>
        </tr>`;
      });

      summaryHTML += `<tr><td colspan="3">總金額</td><td colspan="2">$${total}</td></tr></table>`;
      document.getElementById('summary').innerHTML = summaryHTML;

      // 加上列印時間
      const now = new Date();
      const timeString = now.toLocaleString("zh-TW", { hour12: false });
      document.getElementById('printTime').innerText = "列印時間：" + timeString;
    }

    function clearAll() {
      document.getElementById('orderTable').innerHTML = '';
      document.getElementById('summary').innerHTML = '';
      document.getElementById('printTime').innerText = '';
    }

    window.onload = addRow;
  </script>
</body>
</html>